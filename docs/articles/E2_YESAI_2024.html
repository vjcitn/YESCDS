<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>E2: Language analysis and production with R and some LLMs • YESCDS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="E2: Language analysis and production with R and some LLMs">
<meta property="og:description" content="YESCDS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">YESCDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A0_intro_notebook.html">A0 Introductory Notebook</a>
    </li>
    <li>
      <a href="../articles/A1_cancer_table.html">A1 Cancers in my world</a>
    </li>
    <li>
      <a href="../articles/A2_rates.html">A2 Cancer rates for public health assessment</a>
    </li>
    <li>
      <a href="../articles/A3_monitoring.html">A3 Monitoring of cancer by public health institutions</a>
    </li>
    <li>
      <a href="../articles/A4_interactive_tables.html">A4 Using interactive tables</a>
    </li>
    <li>
      <a href="../articles/A5_data_graphics.html">A5 Data graphics</a>
    </li>
    <li>
      <a href="../articles/A6_standardization.html">A6 Age standardization of cancer rates</a>
    </li>
    <li>
      <a href="../articles/B1_global.html">B1 Cancer across the globe</a>
    </li>
    <li>
      <a href="../articles/B2_table_plus_geo.html">B2 Enhancing tables with geography</a>
    </li>
    <li>
      <a href="../articles/B3_counties.html">B3 Cancer in our counties</a>
    </li>
    <li>
      <a href="../articles/C1_body_overall.html">C1 Cancer in our bodies: Overall view</a>
    </li>
    <li>
      <a href="../articles/C2_variation_survival.html">C2 Variation in survival with cancer</a>
    </li>
    <li>
      <a href="../articles/C3_subtypes_molecular.html">C3 Molecular origins of diverse cancers</a>
    </li>
    <li>
      <a href="../articles/D1_clin_trial_concepts.html">D1 Clinical trials concepts</a>
    </li>
    <li>
      <a href="../articles/D2_equipoise.html">D2 Equipoise: when medical knowledge can only advance by experimenting</a>
    </li>
    <li>
      <a href="../articles/D3_randomization_bias.html">D3 Randomization to reduce bias</a>
    </li>
    <li>
      <a href="../articles/D4_comparing_trt.html">D4 Methods of comparing treatments</a>
    </li>
    <li>
      <a href="../articles/E1_heidelberg2022.html">E1 Inclusive genomic data science education, illustrated with cancer genomics</a>
    </li>
    <li>
      <a href="../articles/E2_YESAI_2024.html">E2: Language analysis and production with R and some LLMs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vjcitn/YESCDS/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="E2_YESAI_2024_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>E2: Language analysis and production with R and some LLMs</h1>
                        <h4 data-toc-skip class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">July 17, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/YESCDS/blob/HEAD/vignettes/E2_YESAI_2024.Rmd"><code>vignettes/E2_YESAI_2024.Rmd</code></a></small>
      <div class="hidden name"><code>E2_YESAI_2024.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="elegant-nonsense">Elegant nonsense<a class="anchor" aria-label="anchor" href="#elegant-nonsense"></a>
</h2>
<p>With a very simple model of English grammar and a little vocabulary, we can randomly generate ‘normal-sounding’ sentences.</p>
<p>Here is a vector of elegant nouns.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nouns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mercedes"</span>, <span class="st">"Tiffany"</span>, <span class="st">"Lamborghini"</span>, <span class="st">"Maserati"</span>, <span class="st">"Tosca"</span>, <span class="st">"La Traviata"</span>,</span>
<span>   <span class="st">"Diamonds"</span>, <span class="st">"Crystal"</span>, <span class="st">"Lenox"</span><span class="op">)</span></span></code></pre></div>
<p>We’ll continue to set up some vectors of verbs (past tense), prepositions, adjectives, prepositions, and indicatives.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pastverbs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"radiated"</span>, <span class="st">"glowed"</span>, <span class="st">"luxuriated"</span>, <span class="st">"ecstatized"</span>, <span class="st">"overwhelmed"</span>,</span>
<span>  <span class="st">"hyperventilated"</span>, <span class="st">"raptured"</span>, <span class="st">"raved"</span>, <span class="st">"stupendousized"</span><span class="op">)</span></span>
<span><span class="va">preps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"on"</span>, <span class="st">"over"</span>, <span class="st">"beyond"</span>, <span class="st">"above"</span>, <span class="st">"beneath"</span>, <span class="st">"within"</span>, <span class="st">"across"</span><span class="op">)</span></span>
<span><span class="va">adjectives</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"magnificent"</span>, <span class="st">"majestic"</span>, <span class="st">"sophisticated"</span>, <span class="st">"exquisite"</span>,</span>
<span>  <span class="st">"glorious"</span>, <span class="st">"regal"</span><span class="op">)</span></span>
<span><span class="va">preps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"on"</span>, <span class="st">"over"</span>, <span class="st">"beyond"</span>, <span class="st">"above"</span>, <span class="st">"beneath"</span>, <span class="st">"within"</span>, <span class="st">"across"</span><span class="op">)</span></span>
<span><span class="va">indic</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"the"</span>, <span class="st">"a"</span>, <span class="st">"any"</span>, <span class="st">"some"</span><span class="op">)</span></span></code></pre></div>
<p>Our model for a sentence is</p>
<pre><code><span><span class="va">indicative</span> <span class="op">+</span> <span class="va">noun</span> <span class="op">+</span> <span class="fu">verb</span><span class="op">(</span><span class="va">tensed</span><span class="op">)</span> <span class="op">+</span> <span class="va">preposition</span> <span class="op">+</span> <span class="va">indicative</span> <span class="op">+</span> <span class="va">adjective</span> <span class="op">+</span> <span class="va">noun</span></span></code></pre>
<p>We produce a sentence by sampling purely randomly from the relevant vocabulary vectors. We use <code>sprintf</code> to substitute our choices into a template of seven strings.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get1</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">x</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">up1</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sentence</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s %s %s %s %s %s %s."</span>, <span class="fu">up1</span><span class="op">(</span><span class="fu">get1</span><span class="op">(</span><span class="va">indic</span><span class="op">)</span><span class="op">)</span>, <span class="fu">get1</span><span class="op">(</span><span class="va">nouns</span><span class="op">)</span>, <span class="fu">get1</span><span class="op">(</span><span class="va">pastverbs</span><span class="op">)</span>,</span>
<span>     <span class="fu">get1</span><span class="op">(</span><span class="va">preps</span><span class="op">)</span>, <span class="fu">get1</span><span class="op">(</span><span class="va">indic</span><span class="op">)</span>, <span class="fu">get1</span><span class="op">(</span><span class="va">adjectives</span><span class="op">)</span>, <span class="fu">get1</span><span class="op">(</span><span class="va">nouns</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span> <span class="co"># reproducible</span></span>
<span><span class="fu">sentence</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A Lamborghini raved over the sophisticated Crystal.</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sentence</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## A La Traviata hyperventilated across a majestic Mercedes.</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sentence</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Some Crystal raptured within a magnificent Maserati.</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sentence</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Some Lamborghini stupendousized within the exquisite Diamonds.</span></span></code></pre>
<p>The potential repetitiousness of purely random sampling can be avoided. In the following sentence generator, we prevent reuse of the initial noun or indicative.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sentence_nr</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">i1</span> <span class="op">=</span> <span class="fu">get1</span><span class="op">(</span><span class="va">indic</span><span class="op">)</span></span>
<span>  <span class="va">n1</span> <span class="op">=</span> <span class="fu">get1</span><span class="op">(</span><span class="va">nouns</span><span class="op">)</span> </span>
<span>  <span class="va">pv1</span> <span class="op">=</span> <span class="fu">get1</span><span class="op">(</span><span class="va">pastverbs</span><span class="op">)</span></span>
<span>  <span class="va">p1</span> <span class="op">=</span> <span class="fu">get1</span><span class="op">(</span><span class="va">preps</span><span class="op">)</span></span>
<span>  <span class="va">i2</span> <span class="op">=</span> <span class="fu">get1</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">indic</span>,<span class="va">i1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># don't repeat indicative</span></span>
<span>  <span class="va">ad</span> <span class="op">=</span> <span class="fu">get1</span><span class="op">(</span><span class="va">adjectives</span><span class="op">)</span> </span>
<span>  <span class="va">n2</span> <span class="op">=</span> <span class="fu">get1</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">nouns</span>,<span class="va">n1</span><span class="op">)</span><span class="op">)</span> <span class="co"># don't repeat noun</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s %s %s %s %s %s %s."</span>, <span class="fu">up1</span><span class="op">(</span><span class="va">i1</span><span class="op">)</span>, <span class="va">n1</span>, <span class="va">pv1</span>, <span class="va">p1</span>, <span class="va">i2</span>, <span class="va">ad</span>, <span class="va">n2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">sentence_nr</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Some Tiffany ecstatized beyond the magnificent Tosca."</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sentence_nr</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Some La Traviata stupendousized beneath any sophisticated Mercedes."</span></span></code></pre>
<p>We can also compose longer sentences, using the conjunction “because”:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linked</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s,\n because %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".$"</span>, <span class="st">""</span>, <span class="fu">sentence_nr</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fu">sentence_nr</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">linked</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Any Mercedes overwhelmed over a sophisticated Maserati,</span></span>
<span><span class="co">##  because The Lamborghini radiated over some magnificent Lenox.</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">linked</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Any Maserati glowed above some glorious Diamonds,</span></span>
<span><span class="co">##  because Any Diamonds raptured across a glorious La Traviata.</span></span></code></pre>
<p>Exercise 1. What does the <code>up1</code> function do? Apply it to the string “foo”. What is the result?</p>
<p>Exercise 2. There is something wrong with the last two productions. What is it and how would you go about correcting it?</p>
</div>
<div class="section level2">
<h2 id="lexical-tagging-of-english-sentences">Lexical tagging of English sentences<a class="anchor" aria-label="anchor" href="#lexical-tagging-of-english-sentences"></a>
</h2>
<p>I asked perplexity.ai ($20/mo) to produce 10 lexically tagged sentences. By “lexical tagging” we refer to a process of associating with each word or phrase a category defining the word’s role in sentence meaning. Examples of tags include</p>
<pre><code>- DT: Determiner
- NN: Noun, singular or mass
- NNP: Proper noun, singular
- VB: Verb, base form
- VBZ: Verb, 3rd person singular present
- JJ: Adjective
- IN: Preposition or subordinating conjunction
- CD: Cardinal number</code></pre>
<p>The full set of “part of speech” tags can be found at the <a href="https://www.ling.upenn.edu/courses/Fall_2003/ling001/penn_treebank_pos.html" class="external-link">U Penn linguistics site</a>.</p>
<p>Here’s what came back from perplexity.ai:</p>
<ul>
<li><p>[The/DT] [Eiffel/NNP] [Tower/NNP] [is/VBZ] [a/DT] [wrought-iron/JJ] [lattice/NN] [tower/NN] [on/IN] [the/DT] [Champ/NNP] [de/NNP] [Mars/NNP] [in/IN] [Paris/NNP] [,/,] [France/NNP] [./.]</p></li>
<li><p>[Photosynthesis/NN] [is/VBZ] [the/DT] [process/NN] [by/IN] [which/WDT] [plants/NNS] [use/VBP] [sunlight/NN] [,/,] [water/NN] [and/CC] [carbon/NN] [dioxide/NN] [to/TO] [produce/VB] [oxygen/NN] [and/CC] [energy/NN] [in/IN] [the/DT] [form/NN] [of/IN] [sugar/NN] [./.]</p></li>
<li><p>[The/DT] [Great/NNP] [Wall/NNP] [of/IN] [China/NNP] [is/VBZ] [a/DT] [series/NN] [of/IN] [fortifications/NNS] [and/CC] [walls/NNS] [built/VBN] [across/IN] [the/DT] [historical/JJ] [northern/JJ] [borders/NNS] [of/IN] [ancient/JJ] [Chinese/JJ] [states/NNS] [./.]</p></li>
<li><p>[William/NNP] [Shakespeare/NNP] [was/VBD] [an/DT] [English/JJ] [playwright/NN] [,/,] [poet/NN] [,/,] [and/CC] [actor/NN] [widely/RB] [regarded/VBN] [as/IN] [the/DT] [greatest/JJS] [writer/NN] [in/IN] [the/DT] [English/JJ] [language/NN] [./.]</p></li>
<li><p>[The/DT] [human/JJ] [genome/NN] [contains/VBZ] [approximately/RB] [3/CD] [billion/CD] [base/NN] [pairs/NNS] [of/IN] [DNA/NN] [./.]</p></li>
<li><p>[Albert/NNP] [Einstein/NNP] [developed/VBD] [the/DT] [theory/NN] [of/IN] [relativity/NN] [,/,] [one/CD] [of/IN] [the/DT] [two/CD] [pillars/NNS] [of/IN] [modern/JJ] [physics/NN] [./.]</p></li>
<li><p>[The/DT] [Amazon/NNP] [rainforest/NN] [,/,] [covering/VBG] [much/JJ] [of/IN] [northwestern/JJ] [Brazil/NNP] [and/CC] [extending/VBG] [into/IN] [Colombia/NNP] [,/,] [Peru/NNP] [and/CC] [other/JJ] [South/NNP] [American/NNP] [countries/NNS] [,/,] [is/VBZ] [the/DT] [world’s/NN$] [largest/JJS] [tropical/JJ] [rainforest/NN] [./.]</p></li>
<li><p>[The/DT] [periodic/JJ] [table/NN] [is/VBZ] [a/DT] [tabular/JJ] [arrangement/NN] [of/IN] [the/DT] [chemical/JJ] [elements/NNS] [,/,] [organized/VBN] [on/IN] [the/DT] [basis/NN] [of/IN] [their/PRP$] [atomic/JJ] [numbers/NNS] [,/,] [electron/NN] [configurations/NNS] [,/,] [and/CC] [recurring/VBG] [chemical/JJ] [properties/NNS] [./.]</p></li>
<li><p>[The/DT] [United/NNP] [Nations/NNPS] [(/] [UN/NNP] [)/] [is/VBZ] [an/DT] [intergovernmental/JJ] [organization/NN] [that/WDT] [aims/VBZ] [to/TO] [maintain/VB] [international/JJ] [peace/NN] [and/CC] [security/NN] [,/,] [develop/VB] [friendly/JJ] [relations/NNS] [among/IN] [nations/NNS] [,/,] [achieve/VB] [international/JJ] [cooperation/NN] [,/,] [and/CC] [be/VB] [a/DT] [center/NN] [for/IN] [harmonizing/VBG] [the/DT] [actions/NNS] [of/IN] [nations/NNS] [./.]</p></li>
<li><p>[The/DT] [Mona/NNP] [Lisa/NNP] [is/VBZ] [a/DT] [half-length/JJ] [portrait/NN] [painting/NN] [by/IN] [Italian/JJ] [artist/NN] [Leonardo/NNP] [da/NNP] [Vinci/NNP] [,/,] [considered/VBN] [an/DT] [archetypal/JJ] [masterpiece/NN] [of/IN] [the/DT] [Italian/NNP] [Renaissance/NNP] [./.]</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="statistics-of-parts-of-speech">Statistics of parts of speech<a class="anchor" aria-label="anchor" href="#statistics-of-parts-of-speech"></a>
</h2>
<p>The sentnce data do not possess a regular structure amenable to tabulation. There is a hierarchical format: arbitrary numbers of language particles and annotations are ordered within each sentence, and the sentences form a group of ten.</p>
<p>A popular format for irregularly structured data is “JSON”. We asked perplexity.ai to produce the tagged sentences in JSON format. R can ingest JSON for programmatic analysis using the jsonlite package.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jeroen.r-universe.dev/jsonlite" class="external-link">jsonlite</a></span><span class="op">)</span></span>
<span><span class="va">myj</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"json/tensent.json"</span>, package<span class="op">=</span><span class="st">"YESCDS"</span><span class="op">)</span></span>
<span><span class="va">sdat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="va">myj</span>, flatten<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">frames</span> <span class="op">=</span> <span class="va">sdat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">frames</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##            word tag</span></span>
<span><span class="co">## 1           The  DT</span></span>
<span><span class="co">## 2        Eiffel NNP</span></span>
<span><span class="co">## 3         Tower NNP</span></span>
<span><span class="co">## 4            is VBZ</span></span>
<span><span class="co">## 5             a  DT</span></span>
<span><span class="co">## 6  wrought-iron  JJ</span></span>
<span><span class="co">## 7       lattice  NN</span></span>
<span><span class="co">## 8         tower  NN</span></span>
<span><span class="co">## 9            on  IN</span></span>
<span><span class="co">## 10          the  DT</span></span>
<span><span class="co">## 11        Champ NNP</span></span>
<span><span class="co">## 12           de NNP</span></span>
<span><span class="co">## 13         Mars NNP</span></span>
<span><span class="co">## 14           in  IN</span></span>
<span><span class="co">## 15        Paris NNP</span></span>
<span><span class="co">## 16            ,   ,</span></span>
<span><span class="co">## 17       France NNP</span></span>
<span><span class="co">## 18            .   .</span></span></code></pre>
<p>We see that for each sentence we have a data.frame with one row for each English word and associated part of speech.</p>
<p>The overall frequency distribution of parts of speech in this little collection is:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alltags</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">frames</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">frames</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">alltags</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    (    )  NN$ NNPS PRP$  VBP  JJS   RB   TO  VBD  WDT   CD  VBG  VBN   VB   CC </span></span>
<span><span class="co">##    1    1    1    1    1    1    2    2    2    2    2    4    4    4    5    9 </span></span>
<span><span class="co">##  VBZ    .    ,  NNS   IN   JJ   DT  NNP   NN </span></span>
<span><span class="co">##    9   10   15   16   25   25   28   29   39</span></span></code></pre>
<p>Here’s how we might use R to determine how many words into a sentence we need to go to find a verb:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">frames</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"VB"</span>, <span class="va">z</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 4 2 6 3 4 3 5 4 7 4</span></span></code></pre>
<p>Exercise 1. What is the position of the verb in the fourth sentence? What is the verb, and what type is it? Consult the link to U Penn linguistics given above.</p>
<p>Exercise 2. Which sentence has the verb in the “latest” position, and why is the position number so high? Should the counting procedure be adjusted?</p>
</div>
<div class="section level2">
<h2 id="using-an-llm">Using an LLM<a class="anchor" aria-label="anchor" href="#using-an-llm"></a>
</h2>
<p>In this section we will assume that you are working on a machine that is able to use software and data organized at huggingface.co, specifically a version of <a href="https://huggingface.co/google-bert/bert-base-uncased" class="external-link">BERT</a>.</p>
<p>We will ‘source’ a github gist that will work if python is present, and if it and the reticulate package have been configured to be able to find python packages torch and transformers.</p>
<p>This code chunk will produce a table of scores and completions for the prompt <code>The capital of Spain is [MASK].</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/source_gist.html" class="external-link">source_gist</a></span><span class="op">(</span><span class="st">"https://gist.github.com/vjcitn/0e1b0289eb1a219b98d60b5b863f8d62"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Sourcing gist "0e1b0289eb1a219b98d60b5b863f8d62"</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> SHA-1 hash of file is "639934f1c514357c798aaa72ac393b501cf9c4b5"</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">##    score token token_str sequence                          </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 0.647   <span style="text-decoration: underline;">6</span>921 madrid    the capital of spain is madrid.   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 0.103   <span style="text-decoration: underline;">7</span>623 barcelona the capital of spain is barcelona.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 0.052<span style="text-decoration: underline;">1</span> <span style="text-decoration: underline;">18</span>983 seville   the capital of spain is seville.  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 0.026<span style="text-decoration: underline;">7</span> <span style="text-decoration: underline;">13</span>083 valencia  the capital of spain is valencia. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 0.021<span style="text-decoration: underline;">8</span> <span style="text-decoration: underline;">27</span>382 malaga    the capital of spain is malaga.</span></span></code></pre>
<p>The code in the gist can be modified to change the model, and the prompt can be changed to seek scored responses to different prompts.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
